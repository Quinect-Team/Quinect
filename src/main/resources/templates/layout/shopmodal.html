<th:block th:fragment="shopmodal">
	<div class="modal fade" id="itemModal" tabindex="-1" role="dialog" aria-labelledby="itemModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
			<div class="modal-content">
				<div class="modal-body p-4">
					<div class="row">
						<div class="col-md-5 mb-3 mb-md-0">
							<div class="modal-item-img">
								<i class="fas fa-gift"></i>
							</div>
						</div>
						<div class="col-md-7 d-flex flex-column justify-content-between">
							<div>
								<h3 class="font-weight-bold text-gray-900 mb-3" id="modalItemName">아이템 이름</h3>
								<p class="text-gray-600" id="modalItemDesc" style="font-size: 1.1rem;">
									여기에 아이템 설명이 들어갑니다.
								</p>
							</div>

							<div id="ownedView" style="display: none;" class="mt-4 text-center p-4 bg-gray-100 rounded">
								<h4 class="font-weight-bold text-gray-600 mb-3">
									<i class="fas fa-check-circle text-success mr-2"></i>이미 보유한 아이템입니다.
								</h4>
								<button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
							</div>

							<div id="purchaseView" class="mt-4">
								<div
									class="d-flex justify-content-between align-items-center mb-3 p-3 bg-gray-100 rounded">
									<span class="font-weight-bold">가격</span>
									<span class="h4 mb-0 font-weight-bold text-success" id="modalItemPrice">0
										P</span>
								</div>

								<div class="d-flex justify-content-between align-items-center mb-4 px-3">
									<span class="small text-gray-600">현재 내 포인트</span>

									<div class="d-flex align-items-center">
										<span id="pointWarning" class="text-danger font-weight-bold mr-2"
											style="display:none; font-size: 0.9rem;">
											<i class="fas fa-exclamation-circle"></i> 포인트가 부족합니다!
										</span>

										<span class="font-weight-bold" id="modalUserPoint"
											th:text="${user != null ? #numbers.formatInteger(user.userProfile.pointBalance, 0, 'COMMA') + ' P' : '0 P'}">
											0 P
										</span>
									</div>
								</div>

								<form th:action="@{/shop/buy}" method="post">
									<input type="hidden" name="itemId" id="hiddenItemId">

									<input type="hidden" name="page" th:value="${param.page}">

									<div class="row">
										<div class="col-6">
											<button type="button" class="btn btn-secondary btn-block btn-lg"
												data-dismiss="modal">취소</button>
										</div>
										<div class="col-6">
											<button type="submit" id="btnBuy"
												class="btn btn-success btn-block btn-lg font-weight-bold">구매</button>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="pointHistoryModal" tabindex="-1" role="dialog" aria-labelledby="pointHistoryLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title font-weight-bold text-gray-900" id="pointHistoryLabel">포인트 내역</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<div class="d-flex justify-content-between align-items-center mb-4 p-3 bg-gray-100 rounded">
						<span class="font-weight-bold text-gray-700">현재 잔액</span>
						<span class="h4 mb-0 font-weight-bold text-success"
							th:text="${user != null ? #numbers.formatInteger(user.userProfile.pointBalance, 0, 'COMMA') + ' P' : '0 P'}">
							0 P
						</span>
					</div>

					<div style="max-height: 300px; overflow-y: auto;">
						<table class="table table-hover">
							<thead class="thead-light">
								<tr>
									<th>날짜</th>
									<th>내용</th>
									<th class="text-right">변동</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td class="small align-middle text-center py-3 text-gray-500" colspan="3">
										<i class="fas fa-spinner fa-spin mr-2"></i>로딩 중...
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
				</div>
			</div>
		</div>
	</div>
</th:block>
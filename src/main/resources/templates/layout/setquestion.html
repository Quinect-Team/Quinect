<style>
	/* 문제 블록 전체 */
	#question-container {
	    max-width: 900px;
	    margin: 0 auto;
	    padding: 0 20px;
	    box-sizing: border-box;
	}

	.question-block {
	    border: 1px solid #ccc;
	    padding: 20px;
	    border-radius: 8px;
	    background: #f8f9fa;
	    margin: 20px auto;
	}

	.question-block input[type="text"] {
	    padding: 8px;
	    width: 100%;
	    border: 1px solid #adb5bd;
	    border-radius: 6px;
	}
	.question-block input[type="text"]:focus {
	    outline: none;
	    border-color: #6c757d;
	    box-shadow: 0 0 0 3px rgba(108,117,125,0.25);
	}

	.choice-buttons {
	    display: flex;
	    gap: 10px;
	    margin-top: 10px;
	}
	
	/* 문제 추가 버튼 */
	.add-question-area {
	    max-width: 900px;
	    margin: 0 auto;
	    display: flex;
	    gap: 10px;
	    justify-content: flex-end;
	}
	.add-question-area button {
	    width: 150px;
	    height: 40px;
	}
	
	/* 선지 추가 버튼 */
	#choices {
		padding: 8px;
		display: flex;
		margin-top: 10px;
		padding-right: 20px;
	}

</style>


<!-- 부트스트랩 -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

<div id="question-container">

	<div class="question-block">
		<div class="d-flex align-items-center" style="gap:10px;">
	        <label class="q-label" for="question" style="margin:0; font-weight:bold;">Q1.</label>

	        <input type="text" name="question" 
	               placeholder="문제를 입력하세요" style="flex:1;">

	        <div class="btn-group dropright">
			  <button type="button" class="btn btn-secondary dropdown-toggle"
			          data-toggle="dropdown">
			    문제 유형
			  </button>
			  <div class="dropdown-menu">
			    <a class="dropdown-item select-type" data-type="short_answer" href="#">서술형</a>
			    <a class="dropdown-item select-type" data-type="multiple_choice" href="#">객관식</a>
			  </div>
			</div>
	    </div>

	    <div class="text-container" style="margin-top:10px;">
	        <input type="text" name="sub" placeholder="지문을 작성하세요" style="width:100%; padding:5px;">

	    </div>
	</div>
</div>

<!-- 문제 추가 -->
<div class="add-question-area">
    <button id="add-question" class="btn btn-secondary">문제 추가</button>
    <button id="remove-question" class="btn btn-secondary">문제 제거</button>
</div>

<!-- Bootstrap & Script -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>


<script>
/* ===============================
   문제 유형 변경 (서술형/객관식)
================================ */
function activateDropdown(block) {

    const typeOptions = block.querySelectorAll('.select-type');
    const answerContainer = block.querySelector('.text-container');

    typeOptions.forEach(option => {
        option.addEventListener('click', function (e) {
            e.preventDefault();

            const type = this.dataset.type;
            answerContainer.innerHTML = "";

            // ▣ 서술형 --------------------
            if (type === "short_answer") {
                const input = document.createElement('input');
                input.type = "text";
                input.placeholder = "지문을 작성하세요";
                input.style = "width:100%; padding:5px;";
                answerContainer.appendChild(input);
            }

            // 객관식
            else if (type === "multiple_choice") {

                // 기본 3개 생성
                for (let i = 1; i <= 3; i++) {
                    const choice = document.createElement("input");
                    choice.type = "text";
                    choice.placeholder = `선택지 ${i}`;
                    choice.style.marginTop = "5px";
                    answerContainer.appendChild(choice);
                }

                // 선택지 + / - 버튼 영역
                const btnBox = document.createElement("div");
                btnBox.className = "choice-buttons";

                const addBtn = document.createElement("button");
                addBtn.className = "btn btn-secondary";
                addBtn.textContent = "+";

                const removeBtn = document.createElement("button");
                removeBtn.className = "btn btn-secondary";
                removeBtn.textContent = "-";

                btnBox.appendChild(addBtn);
                btnBox.appendChild(removeBtn);
                answerContainer.appendChild(btnBox);

                // + 버튼 클릭 → 선택지 추가
                addBtn.addEventListener('click', () => {
                    const newChoice = document.createElement("input");
                    newChoice.type = "text";
                    newChoice.placeholder = `선택지`;
                    newChoice.style.marginTop = "5px";
                    answerContainer.insertBefore(newChoice, btnBox);
                });

                // - 버튼 클릭 → 마지막 선택지 제거
                removeBtn.addEventListener('click', () => {
                    const inputs = answerContainer.querySelectorAll("input");
                    if (inputs.length > 0) {
                        inputs[inputs.length - 1].remove();
                    }
                });
            }
        });
    });
}


/* ===============================
   문제 추가 기능
================================ */
document.getElementById('add-question').addEventListener('click', function () {

    const container = document.getElementById('question-container');
    const blocks = container.querySelectorAll('.question-block');
    const last = blocks[blocks.length - 1];

    const clone = last.cloneNode(true);

    // 번호 재설정
    const newIndex = blocks.length + 1;
    clone.querySelector('.q-label').innerText = `Q${newIndex}.`;

    // 입력값 초기화
    clone.querySelectorAll('input').forEach(el => el.value = '');

    // Dropdown 다시 연결
    activateDropdown(clone);

    container.appendChild(clone);
});


/* ===============================
   문제 제거 기능
================================ */
document.getElementById('remove-question').addEventListener('click', function () {

    const container = document.getElementById('question-container');
    const blocks = container.querySelectorAll('.question-block');

    if (blocks.length <= 1) {
        alert("최소 1개 이상의 문제는 남아 있어야 합니다.");
        return;
    }

    blocks[blocks.length - 1].remove();

    // 번호 재정렬
    const reBlocks = container.querySelectorAll('.question-block');
    reBlocks.forEach((b, i) => {
        b.querySelector('.q-label').innerText = `Q${i + 1}.`;
    });
});


/* ===============================
   최초 로딩 시 실행
================================ */
activateDropdown(document.querySelector('.question-block'));
</script>
